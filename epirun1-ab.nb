(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     66549,       1835]
NotebookOptionsPosition[     62705,       1776]
NotebookOutlinePosition[     63139,       1793]
CellTagsIndexPosition[     63096,       1790]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"blevel", "=", "19"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"alevel", "\[Equal]", "1"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"Row", "[", 
        RowBox[{"{", "\"\<...running Brazil\>\"", "}"}], "]"}], "]"}], ";"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"alevel", "\[Equal]", "2"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<...running states: \>\"", ",", 
          RowBox[{"{", 
           RowBox[{"blevel", ",", 
            RowBox[{"states", "[", 
             RowBox[{"[", "blevel", "]"}], "]"}]}], "}"}]}], "}"}], "]"}], 
       "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"alevel", "\[Equal]", "3"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"stateb", "=", 
       RowBox[{"dataepicovid", "[", 
        RowBox[{"[", 
         RowBox[{"blevel", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<...running cities: \>\"", ",", 
          RowBox[{"{", 
           RowBox[{"blevel", ",", 
            RowBox[{"cities", "[", 
             RowBox[{"[", "blevel", "]"}], "]"}], ",", "stateb"}], "}"}]}], 
         "}"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   ";"}]}]], "Input",ExpressionUUID->"50c52f9c-5b54-4efd-a7f8-d05853da7d9b"],

Cell[CellGroupData[{

Cell["analysis type", "Subsection",ExpressionUUID->"15177f02-0ce9-4093-9bbe-08ed61798ecd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"identifying", " ", "cities"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Dimensions", "[", 
     RowBox[{"citiesIBGE", "=", 
      RowBox[{
      "Import", "[", 
       "\"\<extra/Lista-de-Munic\[IAcute]pios-com-IBGE-Brasil.csv\>\"", 
       "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"alevel", "\[Equal]", "1"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Dimensions", "[", 
       RowBox[{"tabIBGE", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Select", "[", 
            RowBox[{"citiesIBGE", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"StringMatchQ", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"dataepicovid", "[", 
                   RowBox[{"[", 
                    RowBox[{"bb", ",", "2"}], "]"}], "]"}], ",", 
                  RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}], "&&", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
                 RowBox[{"dataepicovid", "[", 
                  RowBox[{"[", 
                   RowBox[{"bb", ",", "1"}], "]"}], "]"}]}]}], ")"}], "&"}]}],
             "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"bb", ",", 
            RowBox[{"Length", "[", "dataepicovid", "]"}]}], "}"}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"tabIBGE", "=", 
        RowBox[{"tabIBGE", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"alevel", "\[Equal]", "2"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"citiesINstate", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"dataepicovid", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
            RowBox[{"states", "[", 
             RowBox[{"[", "blevel", "]"}], "]"}]}], ")"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"tabIBGE", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Select", "[", 
            RowBox[{"citiesIBGE", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"StringMatchQ", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"citiesINstate", "[", 
                   RowBox[{"[", 
                    RowBox[{"bb", ",", "2"}], "]"}], "]"}], ",", 
                  RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}], "&&", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
                 RowBox[{"citiesINstate", "[", 
                  RowBox[{"[", 
                   RowBox[{"bb", ",", "1"}], "]"}], "]"}]}]}], ")"}], "&"}]}],
             "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"bb", ",", 
            RowBox[{"Length", "[", "citiesINstate", "]"}]}], "}"}]}], "]"}]}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"tabIBGE", "=", 
        RowBox[{"tabIBGE", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"alevel", "\[Equal]", "3"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bIBGE", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Select", "[", 
         RowBox[{"citiesIBGE", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"cities", "[", 
                RowBox[{"[", "blevel", "]"}], "]"}], ",", 
               RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}], "&&", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "stateb"}]}], 
            ")"}], "&"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"bIBGE", "=", 
        RowBox[{"bIBGE", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellLabel->
  "(L1) In[134]:=",ExpressionUUID->"e794e9ac-3de8-4a96-bdbd-26ed37926844"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"freq", " ", "antibody", " ", "data"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Which", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alevel", "\[Equal]", "1"}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fa", "=", 
      RowBox[{"datamigb", "[", 
       RowBox[{"[", 
        RowBox[{"blevel", ",", "faval"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sigmafa", "=", 
      RowBox[{"datamigb", "[", 
       RowBox[{"[", 
        RowBox[{"blevel", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"poptot", "=", 
      RowBox[{"Total", "[", 
       RowBox[{"dataepicovid", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"infop", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<Brazil\>\"", ",", "poptot", ",", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"100", "fa"}], ",", ".01"}], "]"}], "]"}], "<>", 
         "\"\<%\>\""}]}], "}"}]}]}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"alevel", "\[Equal]", "2"}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fa", "=", 
      RowBox[{"datamigs", "[", 
       RowBox[{"[", 
        RowBox[{"blevel", ",", "faval"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sigmafa", "=", 
      RowBox[{"datamigs", "[", 
       RowBox[{"[", 
        RowBox[{"blevel", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"poptot", "=", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"dataepicovid", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
             RowBox[{"states", "[", 
              RowBox[{"[", "blevel", "]"}], "]"}]}], ")"}], "&"}]}], "]"}], 
        "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"infop", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"states", "[", 
         RowBox[{"[", "blevel", "]"}], "]"}], ",", "poptot", ",", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"100", "fa"}], ",", ".01"}], "]"}], "]"}], "<>", 
         "\"\<%\>\""}]}], "}"}]}]}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"alevel", "\[Equal]", "3"}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fa", "=", 
      RowBox[{"datamigc", "[", 
       RowBox[{"[", 
        RowBox[{"blevel", ",", "faval"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sigmafa", "=", 
      RowBox[{"datamigc", "[", 
       RowBox[{"[", 
        RowBox[{"blevel", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"poptot", "=", 
      RowBox[{"dataepicovid", "[", 
       RowBox[{"[", 
        RowBox[{"blevel", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"infop", "=", 
      RowBox[{"{", 
       RowBox[{"stateb", ",", "bIBGE", ",", 
        RowBox[{"cities", "[", 
         RowBox[{"[", "blevel", "]"}], "]"}], ",", "poptot", ",", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"fa", "\[Equal]", "\"\<-\>\""}], ",", "fa", ",", 
           RowBox[{"ToString", "[", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"100", "fa"}], ",", ".01"}], "]"}], "]"}]}], "]"}], 
         "<>", "\"\<%\>\""}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "(L1) In[136]:=",ExpressionUUID->"430617af-0d06-4005-bfb9-248cbf22888d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"entries", " ", "with", " ", 
     RowBox[{"#", "[", 
      RowBox[{"[", "codPa", "]"}], "]"}]}], "\[Equal]", 
    RowBox[{
    "\"\<\>\"", " ", "are", " ", "the", " ", "state", " ", "totals"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"entries", " ", "with", " ", 
     RowBox[{"#", "[", 
      RowBox[{"[", "ufPa", "]"}], "]"}]}], "\[Equal]", 
    RowBox[{
    "\"\<\>\"", " ", "are", " ", "the", " ", "Brazilian", " ", "total"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"selentry", "=", 
     RowBox[{"{", 
      RowBox[{"8", ",", "10", ",", "11", ",", "12", ",", "13", ",", "14"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"selentry2", "=", 
     RowBox[{"{", 
      RowBox[{"11", ",", "12", ",", "13", ",", "14"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"header", "[", 
    RowBox[{"[", "selentry", "]"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"AbsoluteTiming", "@", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"alevel", "\[Equal]", "1"}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Dimensions", "[", 
        RowBox[{"tabPa", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"datasaude", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "codPa", "]"}], "]"}], "\[Equal]", 
                RowBox[{"tabIBGE", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "&"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "tabIBGE", "]"}]}], "}"}]}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"tabPa", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1", ",", "8"}], "]"}], "]"}], "]"}], "]"}],
           ">", "1"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"Row", "[", 
           RowBox[{"{", "\"\<Error in Painel C. - Brazil\>\"", "}"}], "]"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Dimensions", "[", 
        RowBox[{"datasaudeF", "=", 
         RowBox[{"tabPa", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "All", ",", "selentry"}], "]"}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Dimensions", "[", 
        RowBox[{
         RowBox[{"datasaudeF", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"3", ";;"}]}], "]"}], "]"}], "=", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"tabPa", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "All", ",", "selentry2"}], "]"}], "]"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Dimensions", "[", "datasaudeF", "]"}]}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"alevel", "\[Equal]", "2"}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Dimensions", "[", 
        RowBox[{"tabPa", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"datasaude", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "codPa", "]"}], "]"}], "\[Equal]", 
                RowBox[{"tabIBGE", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "&"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "tabIBGE", "]"}]}], "}"}]}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"tabPa", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1", ",", "8"}], "]"}], "]"}], "]"}], "]"}],
           ">", "1"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<Error in Painel C. stacking: \>\"", ",", 
             RowBox[{"{", 
              RowBox[{"blevel", ",", 
               RowBox[{"states", "[", 
                RowBox[{"[", "blevel", "]"}], "]"}]}], "}"}]}], "}"}], "]"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Dimensions", "[", 
        RowBox[{"datasaudeF", "=", 
         RowBox[{"tabPa", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "All", ",", "selentry"}], "]"}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Dimensions", "[", 
        RowBox[{
         RowBox[{"datasaudeF", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"3", ";;"}]}], "]"}], "]"}], "=", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"tabPa", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "All", ",", "selentry2"}], "]"}], "]"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Dimensions", "[", "datasaudeF", "]"}]}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"alevel", "\[Equal]", "3"}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Dimensions", "[", 
        RowBox[{"datasaudeF", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"datasaude", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "codPa", "]"}], "]"}], "\[Equal]", "bIBGE"}], 
             ")"}], "&"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Dimensions", "[", 
        RowBox[{"datasaudeF", "=", 
         RowBox[{"datasaudeF", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "selentry"}], "]"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"TableForm", "[", 
    RowBox[{
     RowBox[{"datasaudeF", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "10"}], ";;"}], "]"}], "]"}], ",", 
     RowBox[{"TableHeadings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"None", ",", " ", 
        RowBox[{"header", "[", 
         RowBox[{"[", "selentry", "]"}], "]"}]}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellLabel->
  "(L1) In[137]:=",ExpressionUUID->"b0e0a90b-da58-4fdb-a073-e42c677c1762"]
}, Closed]],

Cell[CellGroupData[{

Cell["tauSD", "Subsection",ExpressionUUID->"cd38e6ce-30ac-4b4e-b385-3ad4af8152c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AbsoluteTiming", "@", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"alevel", "\[Equal]", "1"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Dimensions", "[", 
      RowBox[{"datacovidx", "=", "datasivep"}], "]"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"alevel", "\[Equal]", "2"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Dimensions", "[", 
      RowBox[{"datacovidx", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"datasivep", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "resUF", "]"}], "]"}], "\[Equal]", 
            RowBox[{"states", "[", 
             RowBox[{"[", "blevel", "]"}], "]"}]}], ")"}], "&"}]}], "]"}]}], 
      "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"alevel", "\[Equal]", "3"}], "&&", 
      RowBox[{"stateonly", "\[Equal]", "1"}]}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Dimensions", "[", 
      RowBox[{"datacovidx", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"datasivep", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "resUF", "]"}], "]"}], "\[Equal]", "stateb"}], 
           ")"}], "&"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"alevel", "\[Equal]", "3"}], "&&", 
      RowBox[{"stateonly", "\[Equal]", "0"}]}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Dimensions", "[", 
      RowBox[{"datacovidx", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"datasivep", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "resMUN", "]"}], "]"}], "\[Equal]", "bIBGE"}], 
           RowBox[{"(*", 
            RowBox[{"&&", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "resUF", "]"}], "]"}], "\[Equal]", "stateb"}]}], 
            "*)"}], ")"}], "&"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTiming", "@", 
   RowBox[{"Dimensions", "[", 
    RowBox[{"datacovid", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"datacovidx", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "corona", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "hosp", "]"}], "]"}], "\[Equal]", "1"}], "&&", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "dtSIN", "]"}], "]"}], "\[NotEqual]", 
           "\"\<XXXX\>\""}], "&&", 
          RowBox[{"DateObjectQ", "[", 
           RowBox[{"DateObject", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "dtSIN", "]"}], "]"}], ",", "dateformat"}], "}"}],
             "]"}], "]"}], "&&", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "dtINT", "]"}], "]"}], "\[NotEqual]", 
           "\"\<XXXX\>\""}], "&&", 
          RowBox[{"DateObjectQ", "[", 
           RowBox[{"DateObject", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "dtINT", "]"}], "]"}], ",", "dateformat"}], "}"}],
             "]"}], "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"AbsoluteTime", "[", 
              RowBox[{"DateObject", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "dtINT", "]"}], "]"}], ",", "dateformat"}], 
                "}"}], "]"}], "]"}], "-", 
             RowBox[{"AbsoluteTime", "[", 
              RowBox[{"DateObject", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "dtSIN", "]"}], "]"}], ",", "dateformat"}], 
                "}"}], "]"}], "]"}]}], "\[GreaterEqual]", 
            RowBox[{"(*", ">", "*)"}], "0"}], ")"}], "&&", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "EVO", "]"}], "]"}], "\[Equal]", "2"}], "&&", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "dtEVO", "]"}], "]"}], "\[NotEqual]", 
           "\"\<XXXX\>\""}], "&&", 
          RowBox[{"DateObjectQ", "[", 
           RowBox[{"DateObject", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "dtEVO", "]"}], "]"}], ",", "dateformat"}], "}"}],
             "]"}], "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"AbsoluteTime", "[", 
              RowBox[{"DateObject", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "dtEVO", "]"}], "]"}], ",", "dateformat"}], 
                "}"}], "]"}], "]"}], "-", 
             RowBox[{"AbsoluteTime", "[", 
              RowBox[{"DateObject", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "dtINT", "]"}], "]"}], ",", "dateformat"}], 
                "}"}], "]"}], "]"}]}], "\[GreaterEqual]", "0"}], ")"}]}], 
         ")"}], "&"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"TableForm", "[", 
    RowBox[{
     RowBox[{"datacovid", "[", 
      RowBox[{"[", "All", "]"}], "]"}], ",", 
     RowBox[{"TableHeadings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"None", ",", " ", "header"}], "}"}]}]}], "]"}], 
   "*)"}]}]}], "Input",
 CellLabel->
  "(L1) In[142]:=",ExpressionUUID->"1ff22657-64b6-4443-8c1c-7827b251f5db"],

Cell[BoxData[{
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{"Dimensions", "[", 
   RowBox[{"Deltat", "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"DateDifference", "[", 
        RowBox[{
         RowBox[{"DateObject", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "dtSIN", "]"}], "]"}], ",", "dateformat"}], "}"}], 
          "]"}], ",", 
         RowBox[{"DateObject", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "dtEVO", "]"}], "]"}], ",", "dateformat"}], "}"}], 
          "]"}], ",", "\"\<Days\>\""}], "]"}], "&"}], "/@", "datacovid"}], 
     ")"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Mean", "[", "Deltat", "]"}], ",", 
   RowBox[{"StandardDeviation", "[", "Deltat", "]"}]}], 
  "}"}], "\[IndentingNewLine]", 
 RowBox[{"vecc", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Median", "[", "Deltat", "]"}], ",", 
    RowBox[{"InterquartileRange", "[", "Deltat", "]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"tauSDsivep", "=", 
  RowBox[{"vecc", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "Input",
 CellLabel->
  "(L1) In[144]:=",ExpressionUUID->"cbe3d27e-1fdd-4073-8757-362ef59bb145"],

Cell[BoxData[{
 RowBox[{"MinMax", "[", "Deltat", "]"}], "\[IndentingNewLine]", 
 RowBox[{"hfoda", "=", 
  RowBox[{"Histogram", "[", 
   RowBox[{"Deltat", ",", 
    RowBox[{"{", "1", "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"All", ",", "40"}], "}"}], ",", "All"}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", "14"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"None", ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(t\), \(death\)]\)-\!\(\*SubscriptBox[\(t\), \
\(severe\\\ sympt\)]\) (days)\>\"", ",", "infop"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRangeClipping", "\[Rule]", "True"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Tau]\), \(d\)]\)=\>\"", ",", 
             RowBox[{"Round", "@", 
              RowBox[{"vecc", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "\"\< (\>\"", 
             ",", 
             RowBox[{"Round", "@", 
              RowBox[{"vecc", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
             "\"\<) days\>\""}], "}"}], "]"}], ",", "18"}], "]"}], ",", 
        RowBox[{"Scaled", "[", 
         RowBox[{"{", 
          RowBox[{".7", ",", ".7"}], "}"}], "]"}]}], "]"}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<results/run\>\"", "<>", 
    RowBox[{"ToString", "[", "run", "]"}], "<>", "\"\</\>\"", "<>", 
    RowBox[{"ToString", "[", "run", "]"}], "<>", "\"\<-taud-a\>\"", "<>", 
    RowBox[{"ToString", "[", "alevel", "]"}], "<>", "\"\<-b\>\"", "<>", 
    RowBox[{"ToString", "[", "blevel", "]"}], "<>", "\"\<-m\>\"", "<>", 
    RowBox[{"ToString", "[", "faval", "]"}], "<>", "\"\<-f\>\"", "<>", 
    RowBox[{"ToString", "[", "phase", "]"}], "<>", "\"\<.pdf\>\""}], ",", 
   "hfoda"}], "]"}]}], "Input",
 CellLabel->
  "(L1) In[148]:=",ExpressionUUID->"2089eec0-ea2d-49f8-af48-9dc3afe07227"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "bootstrap", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"databs", "=", 
     RowBox[{"QuantityMagnitude", "[", "Deltat", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Median", "[", "databs", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Dimensions", "[", 
    RowBox[{"medians", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Median", "[", 
        RowBox[{"RandomChoice", "[", 
         RowBox[{"databs", ",", 
          RowBox[{"Length", "[", "databs", "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", "^", "4"}], "}"}]}], "]"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Mean", "[", "medians", "]"}], ",", 
     RowBox[{"tauderr", "=", 
      RowBox[{"StandardDeviation", "[", "medians", "]"}]}]}], "}"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", 
    RowBox[{"medians", ",", 
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", "14"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"None", ",", "None"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(\[Tau]\), \(d\)]\) (days)\>\"", ",", 
          "infop"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotRangeClipping", "\[Rule]", "True"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}]}], "]"}]}]}]], "Input",
 CellLabel->
  "(L1) In[151]:=",ExpressionUUID->"687d04e9-f5fb-41ad-ac53-ad9bdee65bdf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tauSD", "=", 
   RowBox[{"tauSDsivep", "+", "DeltaT"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigtauSD", "=", " ", 
   RowBox[{"Round", "[", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"tauderr", "^", "2"}], "+", 
      RowBox[{"sigmaDT", "^", "2"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"tauSD", ",", "sigtauSD"}], "}"}]}], "Input",
 CellLabel->
  "(L1) In[156]:=",ExpressionUUID->"85763038-9ce7-4b15-8b25-e5744583e38a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tauSD", ",", "sigtauSD"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "*)"}]], "Input",
 CellLabel->
  "(L1) In[159]:=",ExpressionUUID->"f4344a27-1db7-4e20-a8f5-ffceaded13cb"],

Cell[BoxData[{
 RowBox[{"datem", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dates", "=", 
   RowBox[{"DatePlus", "[", 
    RowBox[{"datem", ",", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"-", "tauSA"}], "+", "DeltaT"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dates1p", "=", 
   RowBox[{"DatePlus", "[", 
    RowBox[{"datem", ",", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"-", "tauSA"}], "+", "DeltaT", "+", "sigmaDT"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dates1m", "=", 
   RowBox[{"DatePlus", "[", 
    RowBox[{"datem", ",", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"-", "tauSA"}], "+", "DeltaT", "-", "sigmaDT"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"dates", ",", "dates1p", ",", "dates1m"}], "}"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dated", "=", 
   RowBox[{"DatePlus", "[", 
    RowBox[{"datem", ",", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"-", "tauSA"}], "+", "tauSD"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"datedi", "=", 
    RowBox[{"DatePlus", "[", 
     RowBox[{"dated", ",", 
      RowBox[{"-", "timeab"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dated1p", "=", 
   RowBox[{"DatePlus", "[", 
    RowBox[{"datem", ",", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"-", "tauSA"}], "+", "tauSD", "+", "sigtauSD"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dated1pi", "=", 
    RowBox[{"DatePlus", "[", 
     RowBox[{"dated1p", ",", 
      RowBox[{"-", "timeab"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dated1m", "=", 
   RowBox[{"DatePlus", "[", 
    RowBox[{"datem", ",", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"-", "tauSA"}], "+", "tauSD", "-", "sigtauSD"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dated1mi", "=", 
   RowBox[{"DatePlus", "[", 
    RowBox[{"dated1m", ",", 
     RowBox[{"-", "timeab"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"dated", ",", "dated1p", ",", "dated1m"}], "}"}]}], "Input",
 CellLabel->
  "(L1) In[160]:=",ExpressionUUID->"19901dcd-6581-4d41-87c2-bce4099c611f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"DeltatPDF", "=", 
    RowBox[{"HistogramDistribution", "[", 
     RowBox[{
      RowBox[{"QuantityMagnitude", "[", "Deltat", "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"PDF", "[", 
       RowBox[{"DeltatPDF", ",", "x"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "50"}], "}"}]}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"PDF", "[", 
       RowBox[{"DeltatPDF", ",", "x"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "40"}], "}"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", "14"}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{
       "{", "\"\<\!\(\*SubscriptBox[\(t\), \
\(death\)]\)-\!\(\*SubscriptBox[\(t\), \(severe\\\ sympt\)]\) (days)\>\"", 
        "}"}]}], ",", 
      RowBox[{"Filling", "\[Rule]", "Bottom"}]}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"CDF", "[", 
       RowBox[{"DeltatPDF", ",", "x"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "40"}], "}"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", "14"}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{
       "{", "\"\<\!\(\*SubscriptBox[\(t\), \
\(death\)]\)-\!\(\*SubscriptBox[\(t\), \(severe\\\ sympt\)]\) (days)\>\"", 
        "}"}]}], ",", 
      RowBox[{"Filling", "\[Rule]", "Bottom"}]}], "]"}]}]}], "*)"}]], "Input",\

 CellLabel->
  "(L1) In[172]:=",ExpressionUUID->"c10af996-373f-4aa3-b794-6d5d7edd3e09"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"pdtab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{"CDF", "[", 
        RowBox[{"DeltatPDF", ",", "t"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "40", ",", "1"}], "}"}]}], "]"}]}], 
  "*)"}]], "Input",
 CellLabel->
  "(L1) In[173]:=",ExpressionUUID->"f5d4545f-1e16-45fb-81b6-c24949a27055"]
}, Closed]],

Cell[CellGroupData[{

Cell["nd", "Subsection",ExpressionUUID->"4db921c1-9393-4bc5-8cc8-222108ffa914"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"obData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DateObject", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"datasaudeF", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "dateformat"}], "}"}],
         "]"}], ",", 
       RowBox[{"datasaudeF", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "datasaudeF", "]"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellLabel->
  "(L1) In[111]:=",ExpressionUUID->"810fd0ee-e173-4cdd-bdf1-d65e23a058be"],

Cell[BoxData[{
 RowBox[{"Dimensions", "[", 
  RowBox[{"obDataS", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"obData", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Mean", "[", 
        RowBox[{"obData", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"i", ",", 
             RowBox[{"i", "+", "dbin", "-", "1"}]}], "]"}], ",", "2"}], "]"}],
          "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Length", "[", "obData", "]"}], "-", 
        RowBox[{"(", 
         RowBox[{"dbin", "-", "1"}], ")"}]}], ",", "1"}], 
      RowBox[{"(*", "dbin", "*)"}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"obDataS", "=", "obData"}], ";"}], "*)"}]}]}], "Input",
 CellLabel->
  "(L1) In[174]:=",ExpressionUUID->"ac5c70cf-f190-48f4-856b-fff23f9633e2"],

Cell[BoxData[{
 RowBox[{"dapo", "=", 
  RowBox[{"DateListStepPlot", "[", 
   RowBox[{"obDataS", ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", "14"}], ",", 
    RowBox[{"PlotRangeClipping", "\[Rule]", "True"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"GridLines", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"datei", ",", "datef"}], "}"}], ",", " ", "None"}], "}"}]}],
       ",", 
      RowBox[{"GridLinesStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Blue", ",", 
         RowBox[{"Thickness", "[", ".005", "]"}], ",", "Dashed"}], "]"}]}], 
      ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<GridLinesInFront\>\"", "\[Rule]", "True"}], "}"}]}], 
      ","}], "*)"}], 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DateObject", "[", 
          RowBox[{"{", 
           RowBox[{"2020", ",", "4", ",", "1"}], "}"}], "]"}], ",", 
         "datapainel"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(dn\), \
\(d\)]\)/dt\\ncovid.saude.gov.br\>\"", ",", 
           RowBox[{"FontSize", "\[Rule]", "15"}], ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Left"}]}], "]"}], ",", 
         RowBox[{"Scaled", "[", 
          RowBox[{"{", 
           RowBox[{".25", ",", ".7"}], "}"}], "]"}]}], "]"}], ",", 
       RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
       RowBox[{"Opacity", "[", ".2", "]"}], ",", "Blue", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"datei", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"datef", ",", "10000"}], "}"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", "Bottom"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"None", ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "infop"}], "}"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<results/run\>\"", "<>", 
    RowBox[{"ToString", "[", "run", "]"}], "<>", "\"\</\>\"", "<>", 
    RowBox[{"ToString", "[", "run", "]"}], "<>", "\"\<-nd-a\>\"", "<>", 
    RowBox[{"ToString", "[", "alevel", "]"}], "<>", "\"\<-b\>\"", "<>", 
    RowBox[{"ToString", "[", "blevel", "]"}], "<>", "\"\<-m\>\"", "<>", 
    RowBox[{"ToString", "[", "faval", "]"}], "<>", "\"\<-f\>\"", "<>", 
    RowBox[{"ToString", "[", "phase", "]"}], "<>", "\"\<.pdf\>\""}], ",", 
   "dapo"}], "]"}]}], "Input",
 CellLabel->
  "(L1) In[175]:=",ExpressionUUID->"09cdba86-2a7d-4bee-8a96-86ef4e0395ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"auxx", "=", 
   RowBox[{"AbsoluteTime", "/@", 
    RowBox[{"obDataS", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"obpo", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{"auxx", ",", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"AbsoluteTime", "[", "dated", "]"}], "-", "#"}], 
          "\[Equal]", "0"}], "&"}], ")"}]}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"obpo1p", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{"auxx", ",", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"AbsoluteTime", "[", "dated1p", "]"}], "-", "#"}], 
          "\[Equal]", "0"}], "&"}], ")"}]}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"obpo1m", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{"auxx", ",", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"AbsoluteTime", "[", "dated1m", "]"}], "-", "#"}], 
          "\[Equal]", "0"}], "&"}], ")"}]}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "(L1) In[177]:=",ExpressionUUID->"8d2fe053-29a6-43ae-b50d-13648647b0f3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"AbsoluteTime", "[", "dated1mi", "]"}], "\[LessEqual]", 
      RowBox[{"AbsoluteTime", "[", 
       RowBox[{"obDataS", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"obpoi", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"obpo1pi", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"obpo1mi", "=", "1"}], ";"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"obpoi", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"auxx", ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"AbsoluteTime", "[", "datedi", "]"}], "-", "#"}], 
              "\[Equal]", "0"}], "&"}], ")"}]}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"obpo1pi", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"auxx", ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"AbsoluteTime", "[", "dated1pi", "]"}], "-", "#"}], 
              "\[Equal]", "0"}], "&"}], ")"}]}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"obpo1mi", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"auxx", ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"AbsoluteTime", "[", "dated1mi", "]"}], "-", "#"}], 
              "\[Equal]", "0"}], "&"}], ")"}]}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ndtot", "=", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"obDataS", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"obpoi", ";;", "obpo"}], ",", "2"}], "]"}], "]"}], "]"}], 
    "1."}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ndtot1p", "=", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"obDataS", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"obpo1pi", ";;", "obpo"}], ",", "2"}], "]"}], "]"}], "]"}], 
    "1."}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ndtot1m", "=", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"obDataS", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"obpo1mi", ";;", "obpo"}], ",", "2"}], "]"}], "]"}], "]"}], 
     "1."}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"fd", "=", 
  RowBox[{"ndtot", "/", "poptot"}]}], "\[IndentingNewLine]", 
 RowBox[{"fd1p", "=", 
  RowBox[{"ndtot1p", "/", "poptot"}]}], "\[IndentingNewLine]", 
 RowBox[{"fd1m", "=", 
  RowBox[{"ndtot1m", "/", "poptot"}]}]}], "Input",
 CellLabel->
  "(L1) In[181]:=",ExpressionUUID->"c788436b-956f-440a-9f39-a38486282c79"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"sigmafd", "=", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"fd1p", "-", "fd1m"}], "]"}], "/", "2"}]}], ",", "fd"}], 
  "}"}]], "Input",ExpressionUUID->"bef11526-0bda-447b-95ef-e5d54b422515"]
}, Closed]],

Cell[CellGroupData[{

Cell["ns", "Subsection",ExpressionUUID->"2d70dda7-fd29-4c54-9318-6fcc4e131317"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"siData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DateObject", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"datasaudeF", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "dateformat"}], "}"}],
         "]"}], ",", 
       RowBox[{"datasaudeF", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "4"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "datasaudeF", "]"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellLabel->
  "(L1) In[189]:=",ExpressionUUID->"5fbbe4dd-5b82-4e04-8eab-29ef8cec8b11"],

Cell[BoxData[{
 RowBox[{"Dimensions", "[", 
  RowBox[{"siDataS", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"siData", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Mean", "[", 
        RowBox[{"siData", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"i", ",", 
             RowBox[{"i", "+", "dbin", "-", "1"}]}], "]"}], ",", "2"}], "]"}],
          "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Length", "[", "siData", "]"}], "-", 
        RowBox[{"(", 
         RowBox[{"dbin", "-", "1"}], ")"}]}], ",", "1"}], 
      RowBox[{"(*", "dbin", "*)"}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"siDataS", "=", "siData"}], ";"}], " ", "*)"}]}]}], "Input",
 CellLabel->
  "(L1) In[190]:=",ExpressionUUID->"39b30afa-6744-48c9-be09-3e739ae2150f"],

Cell[BoxData[{
 RowBox[{"dapo", "=", 
  RowBox[{"DateListStepPlot", "[", 
   RowBox[{"siDataS", ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", "14"}], ",", 
    RowBox[{"PlotRangeClipping", "\[Rule]", "True"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"GridLines", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"datei", ",", "datef"}], "}"}], ",", " ", "None"}], "}"}]}],
       ",", 
      RowBox[{"GridLinesStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Blue", ",", 
         RowBox[{"Thickness", "[", ".005", "]"}], ",", "Dashed"}], "]"}]}], 
      ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<GridLinesInFront\>\"", "\[Rule]", "True"}], "}"}]}], 
      ","}], "*)"}], 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DateObject", "[", 
          RowBox[{"{", 
           RowBox[{"2020", ",", "4", ",", "1"}], "}"}], "]"}], ",", 
         "datapainel"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(dn\), \
\(s\)]\)/dt\\ncovid.saude.gov.br\>\"", ",", 
           RowBox[{"FontSize", "\[Rule]", "15"}], ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Left"}]}], "]"}], ",", 
         RowBox[{"Scaled", "[", 
          RowBox[{"{", 
           RowBox[{".25", ",", ".7"}], "}"}], "]"}]}], "]"}], ",", 
       RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
       RowBox[{"Opacity", "[", ".2", "]"}], ",", "Blue", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"datei", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"datef", ",", "100000"}], "}"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"Filling", "\[Rule]", "Bottom"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"None", ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "infop"}], "}"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<results/run\>\"", "<>", 
    RowBox[{"ToString", "[", "run", "]"}], "<>", "\"\</\>\"", "<>", 
    RowBox[{"ToString", "[", "run", "]"}], "<>", "\"\<-ns-a\>\"", "<>", 
    RowBox[{"ToString", "[", "alevel", "]"}], "<>", "\"\<-b\>\"", "<>", 
    RowBox[{"ToString", "[", "blevel", "]"}], "<>", "\"\<-m\>\"", "<>", 
    RowBox[{"ToString", "[", "faval", "]"}], "<>", "\"\<-f\>\"", "<>", 
    RowBox[{"ToString", "[", "phase", "]"}], "<>", "\"\<.pdf\>\""}], ",", 
   "dapo"}], "]"}]}], "Input",
 CellLabel->
  "(L1) In[191]:=",ExpressionUUID->"b78f31d2-f094-4c2e-9bf9-361ca71b7b03"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{"siData", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "1.", 
   "\[IndentingNewLine]", 
   RowBox[{"Total", "[", 
    RowBox[{"siDataS", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "1."}], "*)"}]], "Input",\

 CellLabel->
  "(L1) In[193]:=",ExpressionUUID->"30c24671-2a26-4c28-8ed5-3d0e44e46e08"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"auxx", "=", 
   RowBox[{"AbsoluteTime", "/@", 
    RowBox[{"siDataS", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sipo", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{"auxx", ",", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"AbsoluteTime", "[", "dates", "]"}], "-", "#"}], 
          "\[Equal]", "0"}], "&"}], ")"}]}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nstot", "=", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"siDataS", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{";;", "sipo"}], ",", "2"}], "]"}], "]"}], "]"}], "1."}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"fs", "=", 
  RowBox[{"nstot", "/", "poptot"}]}]}], "Input",
 CellLabel->
  "(L1) In[194]:=",ExpressionUUID->"fa5e1c99-e97e-4ba3-83f8-609bf9691fcc"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"fs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"DateWithinQ", "[", 
          RowBox[{"dates", ",", 
           RowBox[{"First", "@", "#"}]}], "]"}], "&"}], "]"}], "@", 
       "siDataS"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}], "/", "poptot"}]}], "*)"}]], "Input",
 CellLabel->
  "(L1) In[198]:=",ExpressionUUID->"a4cf75a2-1dff-4ea6-8fd0-7d7c963a6357"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sipo", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{"auxx", ",", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"AbsoluteTime", "[", "dates1p", "]"}], "-", "#"}], 
          "\[Equal]", "0"}], "&"}], ")"}]}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nstot1p", "=", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"siDataS", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{";;", "sipo"}], ",", "2"}], "]"}], "]"}], "]"}], "1."}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"fs1p", "=", 
  RowBox[{"nstot1p", "/", "poptot"}]}]}], "Input",
 CellLabel->
  "(L1) In[199]:=",ExpressionUUID->"6fd5286c-37ae-40f4-8c79-e478a52e962b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sipo", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{"auxx", ",", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"AbsoluteTime", "[", "dates1m", "]"}], "-", "#"}], 
          "\[Equal]", "0"}], "&"}], ")"}]}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nstot1m", "=", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"siDataS", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{";;", "sipo"}], ",", "2"}], "]"}], "]"}], "]"}], "1."}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"fs1m", "=", 
  RowBox[{"nstot1m", "/", "poptot"}]}]}], "Input",
 CellLabel->
  "(L1) In[202]:=",ExpressionUUID->"da0acd0c-8544-49e0-8b12-f55a64cd4966"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"sigmafs", "=", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"fs1p", "-", "fs1m"}], "]"}], "/", "2"}]}], ",", "fs"}], 
  "}"}]], "Input",ExpressionUUID->"738727e3-0a85-4c3e-ac41-ca9a803112f6"]
}, Closed]],

Cell[CellGroupData[{

Cell["final", "Subsection",ExpressionUUID->"a1a8702d-82d5-462d-9a21-a3de1cb7a7fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Which", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fa", "\[Equal]", "\"\<-\>\""}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ifr", "=", "\"\<-\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"sifr", "=", "\"\<-\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"etam", "=", "\"\<-\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"setam", "=", "\"\<-\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rsa", ",", "rsifr", ",", "rseta"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{"\"\<-\>\"", ",", "\"\<-\>\"", ",", "\"\<-\>\""}], "}"}]}], 
     ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{"fa", ",", 
       RowBox[{"10", "^", 
        RowBox[{"-", "10"}]}]}], "]"}], "\[Equal]", "0"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ifr", "=", "\"\<-\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"sifr", "=", "\"\<-\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"etam", "=", 
      RowBox[{"fa", "/", "fs"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"setam", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["fa", "2"], "/", 
          SuperscriptBox["fs", "2"]}], " ", 
         RowBox[{
          SuperscriptBox["sigmafs", "2"], "/", 
          SuperscriptBox["fs", "2"]}]}], "+", 
        RowBox[{
         RowBox[{"1", "/", 
          SuperscriptBox["fs", "2"]}], " ", 
         SuperscriptBox["sigmafa", "2"]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rsa", ",", "rsifr", ",", "rseta"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{"\"\<-\>\"", ",", "\"\<-\>\"", ",", "\"\<-\>\""}], "}"}]}], 
     ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{"fs", ",", 
       RowBox[{"10", "^", 
        RowBox[{"-", "10"}]}]}], "]"}], "\[Equal]", "0"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ifr", "=", 
      RowBox[{"fd", "/", "fa"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sifr", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", 
          SuperscriptBox["fa", "2"]}], 
         SuperscriptBox["sigmafd", "2"]}], "+", 
        RowBox[{
         RowBox[{
          SuperscriptBox["fd", "2"], "/", 
          SuperscriptBox["fa", "2"]}], 
         RowBox[{
          SuperscriptBox["sigmafa", "2"], "/", 
          SuperscriptBox["fa", "2"]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"etam", "=", "\"\<-\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"setam", "=", "\"\<-\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rsa", ",", "rsifr", ",", "rseta"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sigmafa", "/", "fa"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Round", "[", 
            RowBox[{"fd", ",", 
             RowBox[{"10", "^", 
              RowBox[{"-", "10"}]}]}], "]"}], "\[Equal]", "0"}], ",", 
          "\"\<-\>\"", ",", 
          RowBox[{"sifr", "/", "ifr"}]}], "]"}], ",", "\"\<-\>\""}], "}"}]}], 
     ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{"0", "\[Equal]", "0"}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ifr", "=", 
      RowBox[{"fd", "/", "fa"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sifr", "=", 
        RowBox[{"ifr", " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox["sigmafd", "2"], "/", 
            SuperscriptBox["fd", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["sigmafa", "2"], "/", 
            SuperscriptBox["fa", "2"]}]}], "]"}]}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sifr", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", 
          SuperscriptBox["fa", "2"]}], " ", 
         SuperscriptBox["sigmafd", "2"]}], "+", 
        RowBox[{
         RowBox[{
          SuperscriptBox["fd", "2"], "/", 
          SuperscriptBox["fa", "2"]}], 
         RowBox[{
          SuperscriptBox["sigmafa", "2"], "/", 
          SuperscriptBox["fa", "2"]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"etam", "=", 
      RowBox[{"fa", "/", "fs"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"setam", "=", 
      RowBox[{"etam", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox["sigmafs", "2"], "/", 
          SuperscriptBox["fs", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["sigmafa", "2"], "/", 
          SuperscriptBox["fa", "2"]}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rsa", ",", "rsifr", ",", "rseta"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sigmafa", "/", "fa"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Round", "[", 
            RowBox[{"fd", ",", 
             RowBox[{"10", "^", 
              RowBox[{"-", "10"}]}]}], "]"}], "\[Equal]", "0"}], ",", 
          "\"\<-\>\"", ",", 
          RowBox[{"sifr", "/", "ifr"}]}], "]"}], ",", 
        RowBox[{"setam", "/", "etam"}]}], "}"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellLabel->
  "(L1) In[206]:=",ExpressionUUID->"9d66566a-771d-4877-b8c2-1de58632466a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vecfoda", "=", 
   RowBox[{"{", 
    RowBox[{
    "etam", ",", "setam", ",", " ", "ifr", ",", "sifr", ",", " ", "fa", ",", 
     " ", "fs", ",", " ", "fd", ",", " ", "tauSD", ",", "rsa", ",", "rsifr", 
     ",", "rseta", ",", 
     RowBox[{"sigmafd", "/", "fd"}], ",", 
     RowBox[{"sigmafs", "/", "fs"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vecfoda", "=", 
   RowBox[{"N", "[", "vecfoda", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extab", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<eta+\>\"", ",", "\"\<sigma-eta\>\"", ",", "\"\<IFR\>\"", ",", 
       "\"\<sigma-ifr\>\"", ",", "\"\<fa\>\"", ",", "\"\<fs\>\"", ",", 
       "\"\<fd\>\"", ",", "\"\<taud\>\"", ",", "\"\<s/fa\>\"", ",", 
       "\"\<s/ifr\>\"", ",", "\"\<s/eta\>\"", ",", "\"\<s/fd\>\"", ",", 
       "\"\<s/fs\>\""}], "}"}], ",", "vecfoda"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", "extab", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<results/run\>\"", "<>", 
    RowBox[{"ToString", "[", "run", "]"}], "<>", "\"\</\>\"", "<>", 
    RowBox[{"ToString", "[", "run", "]"}], "<>", "\"\<-ftab-a\>\"", "<>", 
    RowBox[{"ToString", "[", "alevel", "]"}], "<>", "\"\<-b\>\"", "<>", 
    RowBox[{"ToString", "[", "blevel", "]"}], "<>", "\"\<-m\>\"", "<>", 
    RowBox[{"ToString", "[", "faval", "]"}], "<>", "\"\<-f\>\"", "<>", 
    RowBox[{"ToString", "[", "phase", "]"}], "<>", "\"\<.txt\>\""}], ",", 
   "extab", ",", "\"\<Table\>\""}], "]"}]}], "Input",
 CellLabel->
  "(L1) In[207]:=",ExpressionUUID->"09802dc4-45a5-4dbf-8544-fba83c8518fe"]
}, Closed]]
},
WindowSize->{1089, 777},
WindowMargins->{{290, Automatic}, {Automatic, 0}},
TaggingRules->{"TryRealOnly" -> False},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e175e37a-8f36-46df-bae4-b7e4e3cb2cf2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1743, 44, 325, "Input",ExpressionUUID->"50c52f9c-5b54-4efd-a7f8-d05853da7d9b"],
Cell[CellGroupData[{
Cell[2326, 68, 90, 0, 54, "Subsection",ExpressionUUID->"15177f02-0ce9-4093-9bbe-08ed61798ecd"],
Cell[2419, 70, 5068, 128, 661, "Input",ExpressionUUID->"e794e9ac-3de8-4a96-bdbd-26ed37926844"],
Cell[7490, 200, 4094, 113, 493, "Input",ExpressionUUID->"430617af-0d06-4005-bfb9-248cbf22888d"],
Cell[11587, 315, 7122, 183, 850, "Input",ExpressionUUID->"b0e0a90b-da58-4fdb-a073-e42c677c1762"]
}, Closed]],
Cell[CellGroupData[{
Cell[18746, 503, 82, 0, 38, "Subsection",ExpressionUUID->"cd38e6ce-30ac-4b4e-b385-3ad4af8152c8"],
Cell[18831, 505, 6050, 158, 619, "Input",ExpressionUUID->"1ff22657-64b6-4443-8c1c-7827b251f5db"],
Cell[24884, 665, 1311, 38, 157, "Input",ExpressionUUID->"cbe3d27e-1fdd-4073-8757-362ef59bb145"],
Cell[26198, 705, 2444, 59, 142, "Input",ExpressionUUID->"2089eec0-ea2d-49f8-af48-9dc3afe07227"],
Cell[28645, 766, 1688, 45, 157, "Input",ExpressionUUID->"687d04e9-f5fb-41ad-ac53-ad9bdee65bdf"],
Cell[30336, 813, 524, 15, 73, "Input",ExpressionUUID->"85763038-9ce7-4b15-8b25-e5744583e38a"],
Cell[30863, 830, 294, 9, 30, "Input",ExpressionUUID->"f4344a27-1db7-4e20-a8f5-ffceaded13cb"],
Cell[31160, 841, 2463, 76, 346, "Input",ExpressionUUID->"19901dcd-6581-4d41-87c2-bce4099c611f"],
Cell[33626, 919, 2027, 53, 144, "Input",ExpressionUUID->"c10af996-373f-4aa3-b794-6d5d7edd3e09"],
Cell[35656, 974, 426, 13, 30, "Input",ExpressionUUID->"f5d4545f-1e16-45fb-81b6-c24949a27055"]
}, Closed]],
Cell[CellGroupData[{
Cell[36119, 992, 79, 0, 38, "Subsection",ExpressionUUID->"4db921c1-9393-4bc5-8cc8-222108ffa914"],
Cell[36201, 994, 749, 23, 30, "Input",ExpressionUUID->"810fd0ee-e173-4cdd-bdf1-d65e23a058be"],
Cell[36953, 1019, 1024, 31, 73, "Input",ExpressionUUID->"ac5c70cf-f190-48f4-856b-fff23f9633e2"],
Cell[37980, 1052, 3069, 79, 178, "Input",ExpressionUUID->"09cdba86-2a7d-4bee-8a96-86ef4e0395ab"],
Cell[41052, 1133, 1579, 51, 94, "Input",ExpressionUUID->"8d2fe053-29a6-43ae-b50d-13648647b0f3"],
Cell[42634, 1186, 3311, 96, 409, "Input",ExpressionUUID->"c788436b-956f-440a-9f39-a38486282c79"],
Cell[45948, 1284, 252, 7, 30, "Input",ExpressionUUID->"bef11526-0bda-447b-95ef-e5d54b422515"]
}, Closed]],
Cell[CellGroupData[{
Cell[46237, 1296, 79, 0, 38, "Subsection",ExpressionUUID->"2d70dda7-fd29-4c54-9318-6fcc4e131317"],
Cell[46319, 1298, 723, 22, 30, "Input",ExpressionUUID->"5fbbe4dd-5b82-4e04-8eab-29ef8cec8b11"],
Cell[47045, 1322, 1029, 31, 73, "Input",ExpressionUUID->"39b30afa-6744-48c9-be09-3e739ae2150f"],
Cell[48077, 1355, 3070, 79, 178, "Input",ExpressionUUID->"b78f31d2-f094-4c2e-9bf9-361ca71b7b03"],
Cell[51150, 1436, 445, 14, 52, "Input",ExpressionUUID->"30c24671-2a26-4c28-8ed5-3d0e44e46e08"],
Cell[51598, 1452, 1049, 34, 94, "Input",ExpressionUUID->"fa5e1c99-e97e-4ba3-83f8-609bf9691fcc"],
Cell[52650, 1488, 526, 16, 30, "Input",ExpressionUUID->"a4cf75a2-1dff-4ea6-8fd0-7d7c963a6357"],
Cell[53179, 1506, 856, 27, 73, "Input",ExpressionUUID->"6fd5286c-37ae-40f4-8c79-e478a52e962b"],
Cell[54038, 1535, 856, 27, 73, "Input",ExpressionUUID->"da0acd0c-8544-49e0-8b12-f55a64cd4966"],
Cell[54897, 1564, 252, 7, 30, "Input",ExpressionUUID->"738727e3-0a85-4c3e-ac41-ca9a803112f6"]
}, Closed]],
Cell[CellGroupData[{
Cell[55186, 1576, 82, 0, 38, "Subsection",ExpressionUUID->"a1a8702d-82d5-462d-9a21-a3de1cb7a7fd"],
Cell[55271, 1578, 5716, 155, 738, "Input",ExpressionUUID->"9d66566a-771d-4877-b8c2-1de58632466a"],
Cell[60990, 1735, 1699, 38, 157, "Input",ExpressionUUID->"09802dc4-45a5-4dbf-8544-fba83c8518fe"]
}, Closed]]
}
]
*)

